---
const { name, description, url, image, story, tech, impact, featured = false, compact = false } = Astro.props;
const adventureId = `adventure-${name.toLowerCase().replace(/[^a-z0-9]/g, '-')}`;
---

<div 
  class={`relative flex flex-col items-stretch duration-300 ease-out group adventure-card ${featured ? 'featured-adventure' : ''} ${compact ? 'compact-adventure' : ''}`}
  x-data="{ expanded: false }"
>
  <!-- Main Card -->
  <div 
    @click="expanded = !expanded"
    class={`relative cursor-pointer transition-all duration-300 ease-out rounded-2xl ${
      featured ? 'p-8 lg:p-10' : compact ? 'p-4 sm:p-5' : 'p-7 sm:p-5'
    }`}
    :class="expanded ? 'mb-4' : ''"
  >
    <span
      class="absolute inset-0 z-20 block w-full h-full duration-300 ease-out bg-transparent border border-transparent border-dashed group-hover:-translate-x-1 group-hover:-translate-y-1 group-hover:border group-hover:border-neutral-300 dark:group-hover:border-neutral-600 group-hover:border-dashed rounded-2xl group-hover:bg-white dark:group-hover:bg-neutral-950"
      :class="expanded ? '-translate-x-1 -translate-y-1 border-neutral-300 dark:border-neutral-600 border-dashed bg-white dark:bg-neutral-950' : ''"
    ></span>
    <span
      class="absolute inset-0 z-10 block w-full h-full duration-300 ease-out border border-dashed rounded-2xl border-neutral-300 dark:border-neutral-600 group-hover:translate-x-1 group-hover:translate-y-1"
      :class="expanded ? 'translate-x-1 translate-y-1' : ''"
    ></span>
    <span
      class="relative z-30 block duration-300 ease-out group-hover:-translate-x-1 group-hover:-translate-y-1"
      :class="expanded ? '-translate-x-1 -translate-y-1' : ''"
    >
      <span class="block w-full">
        <img 
          src={image} 
          class={`w-full h-auto rounded-lg object-cover ${
            featured ? 'aspect-[16/10]' : compact ? 'aspect-[16/11]' : 'aspect-[16/9]'
          }`} 
        />
      </span>
      <span class={`block w-full px-1 mb-1 ${featured ? 'mt-6 sm:mt-8' : compact ? 'mt-3 sm:mt-4' : 'mt-5 sm:mt-3'}`}>
        <span
          class={`flex items-center justify-between mb-0 font-semibold tracking-tight text-neutral-900 dark:text-neutral-100 ${
            featured ? 'text-lg lg:text-xl' : compact ? 'text-sm' : 'text-base'
          }`}
        >
          <span>{name}</span>
          <div class="flex items-center space-x-2">
            <a 
              href={url} 
              target="_blank" 
              @click.stop
              class="p-1 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors duration-200"
              title="Visit project"
            >
              <svg
                class="w-4 h-4 stroke-current"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path d="M7 17L17 7M17 7H7M17 7V17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </a>
            <svg
              class="transition-transform duration-300 w-4 h-4 stroke-current"
              :class="expanded ? 'rotate-180' : 'rotate-0'"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path d="M6 9L12 15L18 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
        </span>
        <span class={`text-neutral-600 dark:text-neutral-400 block ${
          featured ? 'text-base' : compact ? 'text-xs' : 'text-sm'
        }`}
          >{description}</span
        >
      </span>
    </span>
  </div>

  <!-- Expanded Content -->
  <div 
    x-show="expanded" 
    x-collapse
    class="overflow-hidden"
  >
    <div class={`pb-6 space-y-6 ${
      featured ? 'px-8 lg:px-10' : compact ? 'px-4 sm:px-5' : 'px-7 sm:px-5'
    }`}>
      
      <!-- Story Section -->
      {story && (
        <div class="space-y-3">
          <h4 class="text-lg font-semibold text-neutral-900 dark:text-neutral-100 flex items-center">
            <svg class="w-5 h-5 mr-2 text-blue-500" fill="currentColor" viewBox="0 0 24 24">
              <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
            </svg>
            The Adventure
          </h4>
          <p class="text-sm text-neutral-600 dark:text-neutral-400 leading-relaxed">
            {story}
          </p>
        </div>
      )}

      <!-- Tech Stack -->
      {tech && tech.length > 0 && (
        <div class="space-y-3">
          <h4 class="text-lg font-semibold text-neutral-900 dark:text-neutral-100 flex items-center">
            <svg class="w-5 h-5 mr-2 text-green-500" fill="currentColor" viewBox="0 0 24 24">
              <path d="M22.46 6c-.77.35-1.6.58-2.46.69.88-.53 1.56-1.37 1.88-2.38-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.56-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.93.07 4.28 4.28 0 0 0 4 2.98 8.521 8.521 0 0 1-5.33 1.84c-.34 0-.68-.02-1.02-.06C3.44 20.29 5.7 21 8.12 21 16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56.84-.6 1.56-1.36 2.14-2.23z"/>
            </svg>
            Tech Arsenal
          </h4>
          <div class="flex flex-wrap gap-2">
            {tech.map((technology) => (
              <span class="px-3 py-1 text-xs font-medium bg-neutral-100 dark:bg-neutral-800 text-neutral-700 dark:text-neutral-300 rounded-full">
                {technology}
              </span>
            ))}
          </div>
        </div>
      )}

      <!-- Impact/Results -->
      {impact && (
        <div class="space-y-3">
          <h4 class="text-lg font-semibold text-neutral-900 dark:text-neutral-100 flex items-center">
            <svg class="w-5 h-5 mr-2 text-purple-500" fill="currentColor" viewBox="0 0 24 24">
              <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/>
            </svg>
            Impact & Results
          </h4>
          <p class="text-sm text-neutral-600 dark:text-neutral-400 leading-relaxed">
            {impact}
          </p>
        </div>
      )}

      <!-- Action Button -->
      <div class="pt-2">
        <a 
          href={url} 
          target="_blank"
          class="inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-neutral-900 dark:bg-neutral-100 dark:text-neutral-900 rounded-lg hover:bg-neutral-800 dark:hover:bg-neutral-200 transition-colors duration-200"
        >
          Explore This Adventure
          <svg class="w-4 h-4 ml-2" fill="currentColor" viewBox="0 0 24 24">
            <path d="M7 17L17 7M17 7H7M17 7V17"/>
          </svg>
        </a>
      </div>
    </div>
  </div>
</div>